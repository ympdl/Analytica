import pandas as pd

df = pd.read_csv('dados.csv')
print(df)

# filtrar para pegar somente 1991
filtragem_a = df[df['ano'] == 1991]

#pegar o idhm
filtragem_i = filtragem_a['idhm']

#calcular a media
media = filtragem_i.mean()

print(f"A média do idhm é: {media}")

estados_maior = filtragem_a[filtragem_a['idhm'] > media] # vendo qual está acima da média
estados_maior = estados_maior['sigla_uf'].unique() # pegando somente a coluna das siglas
print(f"Estados acima da media:\n{estados_maior}")

print("\n")

# ordenando de acordo com o idhm
ordenado = filtragem_a.sort_values(by = 'idhm', ascending=False)
print(ordenado.head(5)) # mostrando os 5 maiores

# analisando os dados com as funções
min = filtragem_a['idhm'].min()
max = filtragem_a['idhm'].max()

estado_min = filtragem_a.loc[filtragem_a['idhm'].idxmin(), 'sigla_uf']
estado_max = filtragem_a.loc[filtragem_a['idhm'].idxmax(), 'sigla_uf']

print("\n")

print(f"Menor IDH de 1991: {min} Estado: {estado_min}")
print(f"Maior IDH de 1991: {max} Estado: {estado_max}")
